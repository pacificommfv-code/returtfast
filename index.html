<!DOCTYPE html>
<html>
<head>
    <title>Returtfast</title>
    <style>
        body {
            font-family: Arial;
            text-align: center;
            margin-top: 30px;
            background-color: #111;
            color: white;
        }

        input, button {
            padding: 8px;
            margin: 5px;
        }

        button {
            background-color: #00c853;
            border: none;
            color: white;
            cursor: pointer;
        }

        #panel {
            display: none;
        }

        #historial {
            margin-top: 20px;
        }

        .movimiento {
            padding: 5px;
            border-bottom: 1px solid gray;
        }

        #gananciaTiempoReal {
            color: #00e676;
            font-weight: bold;
        }

    </style>
</head>
<body>

<h1>Returtfast</h1>

<div id="login">

<input type="text" id="usuario" placeholder="Usuario">
<input type="password" id="password" placeholder="Contraseña">

<br>

<button onclick="registrar()">Registrar</button>
<button onclick="login()">Login</button>

</div>

<div id="panel">

<h2>Usuario: <span id="nombreUsuario"></span></h2>

<h3>Saldo: $<span id="saldo">0</span></h3>

<h3>Ganancia en tiempo real: $<span id="gananciaTiempoReal">0</span></h3>

<input type="number" id="monto" placeholder="Monto a invertir">
<h3>Recargar saldo</h3>

<button onclick="recargarMonto(10)">$10</button>
<button onclick="recargarMonto(50)">$50</button>
<button onclick="recargarMonto(100)">$100</button>
<button onclick="recargarMonto(500)">$500</button>
<br>

<button onclick="invertir()">Invertir</button>
<button onclick="retirar()">Retirar todo</button>
<button onclick="logout()">Cerrar sesión</button>

<div id="historial">

<h3>Historial</h3>

<div id="listaHistorial"></div>

</div>

</div>

<script>
function recargarMonto(monto){

let datos = JSON.parse(localStorage.getItem(usuarioActual));

datos.saldo += monto;

datos.historial.push(
"Recarga rápida $" + monto + " - " + new Date().toLocaleString()
);

localStorage.setItem(usuarioActual, JSON.stringify(datos));

actualizarSaldo();
mostrarHistorial();

alert("Recargaste $" + monto);

}
let usuarioActual = null;
let intervaloGanancia = null;

function registrar(){

let usuario = document.getElementById("usuario").value;
let password = document.getElementById("password").value;

if(localStorage.getItem(usuario)){
alert("Usuario existe");
return;
}

let datos = {

password: password,
saldo: 100,
invertido: 0,
historial: []

};

localStorage.setItem(usuario, JSON.stringify(datos));

alert("Usuario creado con $100");

}

function login(){

let usuario = document.getElementById("usuario").value;
let password = document.getElementById("password").value;

let datos = JSON.parse(localStorage.getItem(usuario));

if(!datos || datos.password !== password){

alert("Error login");
return;

}

usuarioActual = usuario;

document.getElementById("login").style.display="none";
document.getElementById("panel").style.display="block";

document.getElementById("nombreUsuario").innerText = usuario;

actualizarSaldo();
mostrarHistorial();

iniciarGanancias();

}

function invertir(){

let monto = parseFloat(document.getElementById("monto").value);

let datos = JSON.parse(localStorage.getItem(usuarioActual));

if(monto > datos.saldo){

alert("Saldo insuficiente");
return;

}

datos.saldo -= monto;
datos.invertido += monto;

datos.historial.push("Invirtió $" + monto + " " + new Date().toLocaleTimeString());

localStorage.setItem(usuarioActual, JSON.stringify(datos));

actualizarSaldo();
mostrarHistorial();

}

function retirar(){

let datos = JSON.parse(localStorage.getItem(usuarioActual));

datos.saldo += datos.invertido;

datos.historial.push("Retiró $" + datos.invertido + " " + new Date().toLocaleTimeString());

datos.invertido = 0;

localStorage.setItem(usuarioActual, JSON.stringify(datos));

actualizarSaldo();
mostrarHistorial();

}

function actualizarSaldo(){

let datos = JSON.parse(localStorage.getItem(usuarioActual));

document.getElementById("saldo").innerText = datos.saldo.toFixed(2);

}

function mostrarHistorial(){

let datos = JSON.parse(localStorage.getItem(usuarioActual));

let lista = document.getElementById("listaHistorial");

lista.innerHTML = "";

datos.historial.slice().reverse().forEach(m => {

let div = document.createElement("div");

div.className="movimiento";

div.innerText=m;

lista.appendChild(div);

});

}

function iniciarGanancias(){

intervaloGanancia = setInterval(()=>{

let datos = JSON.parse(localStorage.getItem(usuarioActual));

if(datos.invertido > 0){

let ganancia = datos.invertido * 0.002;

datos.saldo += ganancia;

document.getElementById("gananciaTiempoReal").innerText = ganancia.toFixed(2);

localStorage.setItem(usuarioActual, JSON.stringify(datos));

actualizarSaldo();

}

},1000);

}

function logout(){

clearInterval(intervaloGanancia);

usuarioActual = null;

document.getElementById("login").style.display="block";
document.getElementById("panel").style.display="none";

}

</script>

</body>

</html>

